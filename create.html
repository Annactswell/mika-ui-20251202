<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mika Studio | Create Magic</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700;900&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'acid-yellow': '#DFFF00',
                        'jungle-green': '#00684A',
                        'soft-cream': '#FFFDF5',
                        'monster-purple': '#9D4EDD',
                        'hot-pink': '#FF0099',
                    },
                    fontFamily: {
                        'display': ['"Poppins"', 'sans-serif'],
                        'body': ['"Inter"', 'sans-serif'],
                    },
                    boxShadow: {
                        'hard': '5px 5px 0px 0px #000000',
                        'hard-hover': '2px 2px 0px 0px #000000',
                        'card': '8px 8px 0px 0px #000000',
                        'inner-hard': 'inset 4px 4px 0px 0px #000000',
                    }
                }
            }
        }
    </script>

    <style>
        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: #FFFDF5; border-left: 3px solid black; }
        ::-webkit-scrollbar-thumb { background: #00684A; border: 3px solid black; }
        ::-webkit-scrollbar-thumb:hover { background: #DFFF00; }

        .doodle-bg {
            background-image: radial-gradient(#000 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .brutal-btn { transition: all 0.1s ease; }
        .brutal-btn:active { transform: translate(4px, 4px); box-shadow: 0px 0px 0px 0px #000000; }

        /* Custom Range Slider */
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #DFFF00;
            border: 3px solid black;
            cursor: pointer;
            margin-top: -10px; 
            box-shadow: 2px 2px 0px 0px #000000;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            background: #000;
            border-radius: 4px;
            border: 2px solid black;
        }

        /* Aspect Ratio Radio Button Logic */
        .ratio-radio:checked + label {
            background-color: #9D4EDD;
            color: white;
            box-shadow: 2px 2px 0px 0px #000000;
            transform: translate(2px, 2px);
        }
        
        /* Style Radio Button Logic */
        .style-radio:checked + label {
            border-color: #000;
            background-color: #DFFF00;
        }
        .style-radio:checked + label .check-icon {
            opacity: 1;
        }

        .loading-overlay {
            background-image: repeating-linear-gradient(
                45deg,
                #000 0,
                #000 10px,
                #DFFF00 10px,
                #DFFF00 20px
            );
            background-size: 200% 200%;
            animation: barberpole 2s linear infinite;
        }
        
        @keyframes barberpole {
            100% { background-position: 100% 100%; }
        }
    </style>
</head>
<body class="bg-soft-cream font-body text-black overflow-x-hidden h-screen flex flex-col">

    <!-- Top Navigation -->
    <nav class="border-b-4 border-black bg-acid-yellow shrink-0">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <a href="index.html" class="flex items-center gap-2 cursor-pointer group hover:scale-105 transition-transform">
                    <span class="font-display text-5xl tracking-widest uppercase italic" style="text-shadow: 4px 4px 0px #FFF;">Mika</span>
                </a>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8 font-bold text-lg">
                    <a href="templates.html" class="hover:text-jungle-green hover:underline decoration-4 decoration-jungle-green underline-offset-4">Templates</a>
                    <a href="gallery.html" class="hover:text-jungle-green hover:underline decoration-4 decoration-jungle-green underline-offset-4">Gallery</a>
                    <a href="models.html" class="hover:text-jungle-green hover:underline decoration-4 decoration-jungle-green underline-offset-4">Models</a>
                    <a href="challenges.html" class="hover:text-jungle-green hover:underline decoration-4 decoration-jungle-green underline-offset-4">Challenges</a>
                    <a href="library.html" class="hover:text-jungle-green hover:underline decoration-4 decoration-jungle-green underline-offset-4">Library</a>
                    <div class="flex items-center gap-2 bg-white border-2 border-black rounded-full px-3 py-1 shadow-hard-hover">
                        <i data-lucide="coins" class="w-5 h-5 text-yellow-500 fill-current"></i>
                        <span class="font-bold">50</span>
                    </div>
                    <a href="profile.html" class="w-10 h-10 rounded-full bg-monster-purple border-2 border-black overflow-hidden hover:scale-110 transition-transform">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User" class="w-full h-full object-cover">
                    </a>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button class="p-2 border-2 border-black bg-white shadow-hard rounded-md">
                        <i data-lucide="menu" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Workspace -->
    <div class="flex-1 flex flex-col md:flex-row overflow-hidden">
        
        <!-- Left Sidebar: Controls (Scrollable) -->
        <aside class="w-full md:w-[450px] bg-white border-r-4 border-black p-6 overflow-y-auto z-10 shadow-[4px_0px_0px_0px_rgba(0,0,0,0.1)]">
            <div class="space-y-8">
                
                <!-- Prompt Input -->
                <div class="space-y-2">
                    <div class="flex justify-between items-end">
                        <label class="font-display text-xl uppercase">Prompt</label>
                        <button class="text-xs font-bold bg-gray-200 px-2 py-1 rounded border border-black hover:bg-acid-yellow flex items-center gap-1" onclick="randomizePrompt()">
                            <i data-lucide="dices" class="w-3 h-3"></i> Random
                        </button>
                    </div>
                    <textarea id="promptInput" class="w-full h-32 p-4 bg-soft-cream border-4 border-black rounded-xl font-bold text-lg resize-none focus:outline-none focus:ring-4 focus:ring-acid-yellow/50 shadow-inner-hard" placeholder="Describe your electric dream... e.g. Cyberpunk street vendor selling neon noodles, raining, cinematic lighting"></textarea>
                </div>

                <!-- Image Reference Upload -->
                <div class="space-y-2">
                    <label class="font-display text-xl uppercase flex items-center gap-2">
                        Ref Image
                        <span class="text-xs bg-black text-white px-2 py-0.5 rounded-full">Optional</span>
                    </label>
                    <div class="border-4 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-black hover:bg-gray-50 transition-colors cursor-pointer group">
                        <i data-lucide="image-up" class="w-8 h-8 mx-auto mb-2 text-gray-400 group-hover:text-black"></i>
                        <p class="font-bold text-sm text-gray-500 group-hover:text-black">Drop image here or click to upload</p>
                    </div>
                </div>

                <!-- Settings Grid -->
                <div class="grid grid-cols-1 gap-6">
                    
                    <!-- Aspect Ratio -->
                    <div>
                        <label class="font-display text-lg uppercase block mb-3">Aspect Ratio</label>
                        <div class="flex gap-3">
                            <div class="flex-1">
                                <input type="radio" name="aspect" id="ratio-1" class="hidden ratio-radio" checked>
                                <label for="ratio-1" class="flex flex-col items-center justify-center border-4 border-black rounded-lg p-3 cursor-pointer hover:bg-gray-50 transition-all bg-white h-20 shadow-hard-hover">
                                    <div class="w-6 h-6 border-2 border-black bg-gray-200 mb-1"></div>
                                    <span class="text-xs font-bold">1:1</span>
                                </label>
                            </div>
                            <div class="flex-1">
                                <input type="radio" name="aspect" id="ratio-2" class="hidden ratio-radio">
                                <label for="ratio-2" class="flex flex-col items-center justify-center border-4 border-black rounded-lg p-3 cursor-pointer hover:bg-gray-50 transition-all bg-white h-20 shadow-hard-hover">
                                    <div class="w-8 h-5 border-2 border-black bg-gray-200 mb-1"></div>
                                    <span class="text-xs font-bold">16:9</span>
                                </label>
                            </div>
                            <div class="flex-1">
                                <input type="radio" name="aspect" id="ratio-3" class="hidden ratio-radio">
                                <label for="ratio-3" class="flex flex-col items-center justify-center border-4 border-black rounded-lg p-3 cursor-pointer hover:bg-gray-50 transition-all bg-white h-20 shadow-hard-hover">
                                    <div class="w-5 h-8 border-2 border-black bg-gray-200 mb-1"></div>
                                    <span class="text-xs font-bold">9:16</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Style Presets -->
                    <div>
                        <label class="font-display text-lg uppercase block mb-3">Style</label>
                        <div class="grid grid-cols-2 gap-3">
                            <!-- Style 1 -->
                            <div class="relative">
                                <input type="radio" name="style" id="style-1" class="hidden style-radio" checked>
                                <label for="style-1" class="block border-4 border-black rounded-lg p-2 cursor-pointer bg-white hover:-translate-y-1 transition-transform overflow-hidden relative h-24 group">
                                    <img src="https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" class="absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity">
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                                    <span class="absolute bottom-2 left-2 text-white font-bold text-sm z-10">Mika V5</span>
                                    <div class="check-icon absolute top-2 right-2 bg-acid-yellow rounded-full p-0.5 opacity-0 transition-opacity">
                                        <i data-lucide="check" class="w-3 h-3 text-black"></i>
                                    </div>
                                </label>
                            </div>
                            <!-- Style 2 -->
                            <div class="relative">
                                <input type="radio" name="style" id="style-2" class="hidden style-radio">
                                <label for="style-2" class="block border-4 border-black rounded-lg p-2 cursor-pointer bg-white hover:-translate-y-1 transition-transform overflow-hidden relative h-24 group">
                                    <img src="https://images.unsplash.com/photo-1563089145-599997674d42?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" class="absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity">
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                                    <span class="absolute bottom-2 left-2 text-white font-bold text-sm z-10">Anime</span>
                                    <div class="check-icon absolute top-2 right-2 bg-acid-yellow rounded-full p-0.5 opacity-0 transition-opacity">
                                        <i data-lucide="check" class="w-3 h-3 text-black"></i>
                                    </div>
                                </label>
                            </div>
                            <!-- Style 3 -->
                            <div class="relative">
                                <input type="radio" name="style" id="style-3" class="hidden style-radio">
                                <label for="style-3" class="block border-4 border-black rounded-lg p-2 cursor-pointer bg-white hover:-translate-y-1 transition-transform overflow-hidden relative h-24 group">
                                    <img src="https://images.unsplash.com/photo-1618172193763-c511deb635ca?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" class="absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity">
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                                    <span class="absolute bottom-2 left-2 text-white font-bold text-sm z-10">3D Render</span>
                                    <div class="check-icon absolute top-2 right-2 bg-acid-yellow rounded-full p-0.5 opacity-0 transition-opacity">
                                        <i data-lucide="check" class="w-3 h-3 text-black"></i>
                                    </div>
                                </label>
                            </div>
                             <!-- Style 4 -->
                             <div class="relative">
                                <input type="radio" name="style" id="style-4" class="hidden style-radio">
                                <label for="style-4" class="block border-4 border-black rounded-lg p-2 cursor-pointer bg-white hover:-translate-y-1 transition-transform overflow-hidden relative h-24 group">
                                    <img src="https://images.unsplash.com/photo-1549490349-8643362247b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" class="absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity">
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                                    <span class="absolute bottom-2 left-2 text-white font-bold text-sm z-10">Oil Painting</span>
                                    <div class="check-icon absolute top-2 right-2 bg-acid-yellow rounded-full p-0.5 opacity-0 transition-opacity">
                                        <i data-lucide="check" class="w-3 h-3 text-black"></i>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Sliders Group -->
                    <div class="space-y-6">
                        <!-- Guidance Scale -->
                        <div>
                            <div class="flex justify-between mb-1">
                                 <label class="font-display text-sm uppercase">Guidance Scale</label>
                                 <span class="font-bold text-sm">7.0</span>
                            </div>
                            <input type="range" min="1" max="20" value="7" class="w-full">
                        </div>

                        <!-- Batch Count -->
                        <div>
                            <div class="flex justify-between mb-1">
                                 <label class="font-display text-sm uppercase">Batch Size</label>
                                 <span class="font-bold text-sm" id="batchValue">1</span>
                            </div>
                            <input type="range" min="1" max="4" value="1" step="1" class="w-full" id="batchSlider">
                            <div class="flex justify-between text-xs font-bold text-gray-400 mt-1">
                                <span>1</span><span>2</span><span>3</span><span>4</span>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Generate Button -->
                <div class="pt-4">
                    <button id="generateBtn" class="brutal-btn w-full bg-jungle-green text-acid-yellow font-display text-2xl py-4 rounded-xl border-4 border-black shadow-hard hover:shadow-hard-hover hover:bg-black hover:text-white flex items-center justify-center gap-3">
                        <i data-lucide="zap" class="w-6 h-6 fill-current"></i>
                        GENERATE
                        <span class="text-sm font-sans bg-black/20 px-2 py-1 rounded">-2 Credits</span>
                    </button>
                </div>

            </div>
        </aside>

        <!-- Right Area: Canvas / Result -->
        <main class="flex-1 bg-doodle-bg relative flex flex-col">
            
            <!-- Toolbar -->
            <div class="h-16 border-b-4 border-black bg-white flex items-center justify-between px-6">
                <div class="font-bold text-gray-400 hidden md:block"># Session: 8X29A</div>
                
                <!-- Simplified Toolbar (Removed Painting Tools) -->
                <div class="flex items-center gap-2 bg-gray-100 rounded-lg p-1 border-2 border-black opacity-50 cursor-not-allowed" title="Select an image to edit">
                    <button class="p-2 rounded" disabled><i data-lucide="move" class="w-5 h-5"></i></button>
                    <button class="p-2 rounded" disabled><i data-lucide="paintbrush" class="w-5 h-5"></i></button>
                    <button class="p-2 rounded" disabled><i data-lucide="eraser" class="w-5 h-5"></i></button>
                </div>

                <div class="flex gap-4">
                     <button class="p-2 hover:bg-gray-100 rounded border-2 border-transparent hover:border-black transition-all" title="Download">
                        <i data-lucide="download" class="w-5 h-5"></i>
                     </button>
                     <button class="p-2 hover:bg-gray-100 rounded border-2 border-transparent hover:border-black transition-all" title="Share">
                        <i data-lucide="share-2" class="w-5 h-5"></i>
                     </button>
                </div>
            </div>

            <!-- Main Viewport -->
            <div class="flex-1 p-8 flex items-center justify-center overflow-hidden relative" id="canvasArea">
                
                <!-- Placeholder State -->
                <div id="placeholderState" class="text-center animate__animated animate__fadeIn">
                    <div class="w-48 h-48 bg-soft-cream border-4 border-black rounded-full flex items-center justify-center mx-auto mb-6 shadow-card rotate-3">
                        <i data-lucide="image-plus" class="w-20 h-20 text-gray-300"></i>
                    </div>
                    <h2 class="font-display text-4xl text-gray-400 mb-2">Canvas Empty</h2>
                    <p class="font-bold text-gray-400">Enter a prompt and hit Generate to start cooking.</p>
                </div>

                <!-- Loading State (Hidden by default) -->
                <div id="loadingState" class="hidden absolute inset-0 bg-white/90 z-20 flex flex-col items-center justify-center">
                    <div class="w-64 h-8 border-4 border-black rounded-full overflow-hidden bg-white shadow-hard">
                        <div class="h-full w-full loading-overlay"></div>
                    </div>
                    <p class="font-display text-2xl mt-6 animate-pulse">Constructing Pixels...</p>
                    <p class="font-bold text-gray-500 mt-2" id="loadingText">Warming up GPUs...</p>
                </div>

                <!-- Result Grid -->
                <div id="resultContainer" class="hidden w-full h-full flex items-center justify-center">
                    <!-- Single Image View (Default) -->
                    <div id="singleResult" class="relative group max-w-full max-h-full transition-all duration-300">
                        <div class="bg-white p-2 border-4 border-black shadow-card transform rotate-1 hover:rotate-0 transition-transform">
                            <img id="resultImage" src="" class="max-h-[70vh] max-w-full object-contain border-2 border-black">
                        </div>
                        <!-- Actions -->
                        <div class="absolute -bottom-6 -right-6 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10">
                             <button class="brutal-btn bg-acid-yellow border-2 border-black px-4 py-2 font-bold rounded-lg shadow-hard text-sm hover:bg-black hover:text-white">
                                Upscale
                             </button>
                             <button class="brutal-btn bg-white border-2 border-black px-4 py-2 font-bold rounded-lg shadow-hard text-sm hover:bg-black hover:text-white">
                                Variations
                             </button>
                             <button class="brutal-btn bg-white border-2 border-black px-4 py-2 font-bold rounded-lg shadow-hard text-sm hover:bg-acid-yellow hover:text-black" onclick="alert('Saved to Library!')">
                                <i data-lucide="bookmark" class="w-4 h-4 inline-block mr-1"></i> Save
                             </button>
                             <button onclick="goToRefine()" class="brutal-btn bg-monster-purple text-white border-2 border-black px-4 py-2 font-bold rounded-lg shadow-hard text-sm hover:bg-black">
                                Edit / Refine
                             </button>
                        </div>
                    </div>

                    <!-- Batch Grid View (Hidden initially) -->
                    <div id="batchGrid" class="hidden grid-cols-2 gap-4 w-full max-w-4xl h-full p-4 overflow-y-auto">
                        <!-- Items injected via JS -->
                    </div>
                </div>

            </div>

            <!-- History Strip (Bottom) -->
            <div class="h-32 border-t-4 border-black bg-white overflow-x-auto p-4 flex gap-4 items-center shrink-0">
                <div class="text-xs font-bold uppercase w-16 text-center text-gray-400 leading-tight">Recent<br>Gens</div>
                <!-- History Item -->
                <div class="w-20 h-20 border-2 border-black rounded-lg overflow-hidden shrink-0 cursor-pointer hover:opacity-80">
                    <img src="https://images.unsplash.com/photo-1578301978693-85fa9c0320b9?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" class="w-full h-full object-cover">
                </div>
                <div class="w-20 h-20 border-2 border-black rounded-lg overflow-hidden shrink-0 cursor-pointer hover:opacity-80">
                    <img src="https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" class="w-full h-full object-cover">
                </div>
                 <div class="w-20 h-20 border-2 border-black rounded-lg overflow-hidden shrink-0 cursor-pointer hover:opacity-80 opacity-50">
                    <div class="w-full h-full bg-gray-100 flex items-center justify-center">
                        <i data-lucide="history" class="w-6 h-6 text-gray-300"></i>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        lucide.createIcons();

        const prompts = [
            "A futuristic cyberpunk street food vendor serving neon ramen in the rain",
            "A portrait of a robotic cat with emerald eyes in the style of oil painting",
            "Isometric 3D render of a cozy cottage in a magical forest",
            "Synthwave sunset over a grid landscape with mountains",
            "Steampunk airship floating above Victorian London clouds"
        ];

        const loadingTexts = [
            "Warming up GPUs...",
            "Consulting the Oracle...",
            "Mixing colors...",
            "Applying magic dust...",
            "Almost there..."
        ];

        const demoImages = [
            "https://images.unsplash.com/photo-1618172193763-c511deb635ca?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
            "https://images.unsplash.com/photo-1563089145-599997674d42?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
            "https://images.unsplash.com/photo-1549490349-8643362247b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80",
            "https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80"
        ];

        function randomizePrompt() {
            const input = document.getElementById('promptInput');
            input.value = prompts[Math.floor(Math.random() * prompts.length)];
        }

        // Batch Slider Logic
        const batchSlider = document.getElementById('batchSlider');
        const batchValue = document.getElementById('batchValue');
        batchSlider.addEventListener('input', (e) => {
            batchValue.innerText = e.target.value;
        });

        const generateBtn = document.getElementById('generateBtn');
        const placeholderState = document.getElementById('placeholderState');
        const loadingState = document.getElementById('loadingState');
        const resultContainer = document.getElementById('resultContainer');
        const singleResult = document.getElementById('singleResult');
        const batchGrid = document.getElementById('batchGrid');
        const resultImage = document.getElementById('resultImage');
        const loadingText = document.getElementById('loadingText');

        generateBtn.addEventListener('click', () => {
            // Start Generation UI Flow
            placeholderState.classList.add('hidden');
            resultContainer.classList.add('hidden');
            loadingState.classList.remove('hidden');
            
            // Cycle loading text
            let textIdx = 0;
            const textInterval = setInterval(() => {
                textIdx = (textIdx + 1) % loadingTexts.length;
                loadingText.innerText = loadingTexts[textIdx];
            }, 800);

            // Simulate API delay
            setTimeout(() => {
                clearInterval(textInterval);
                loadingState.classList.add('hidden');
                resultContainer.classList.remove('hidden');
                
                const count = parseInt(batchSlider.value);
                
                if (count === 1) {
                    // Single View
                    batchGrid.classList.add('hidden');
                    batchGrid.classList.remove('grid');
                    singleResult.classList.remove('hidden');
                    
                    // Select a random image and set it
                    const selectedImg = demoImages[Math.floor(Math.random() * demoImages.length)];
                    resultImage.src = selectedImg;
                    resultImage.dataset.url = selectedImg; // Store for navigation
                    
                    singleResult.classList.add('animate__animated', 'animate__zoomIn');
                } else {
                    // Batch View
                    singleResult.classList.add('hidden');
                    batchGrid.classList.remove('hidden');
                    batchGrid.classList.add('grid');
                    batchGrid.innerHTML = ''; // Clear prev
                    
                    for(let i=0; i<count; i++) {
                        const imgUrl = demoImages[i % demoImages.length];
                        const item = document.createElement('div');
                        item.className = 'bg-white p-2 border-4 border-black shadow-card hover:-translate-y-1 transition-transform animate__animated animate__fadeInUp group relative';
                        item.style.animationDelay = `${i * 0.1}s`;
                        // Batch item with actions
                        item.innerHTML = `
                            <div class="relative">
                                <img src="${imgUrl}" class="w-full h-48 object-cover border-2 border-black mb-2">
                                <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2">
                                    <button onclick="goToRefine('${imgUrl}')" class="bg-monster-purple text-white px-3 py-1 rounded-lg font-bold text-xs border-2 border-black hover:scale-110 transition-transform">
                                        <i data-lucide="paintbrush" class="w-4 h-4"></i> Edit
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between">
                                <button class="text-xs font-bold bg-acid-yellow border border-black px-2 py-1 rounded hover:bg-black hover:text-white">U${i+1}</button>
                                <button class="text-xs font-bold bg-white border border-black px-2 py-1 rounded hover:bg-black hover:text-white">V${i+1}</button>
                            </div>
                        `;
                        batchGrid.appendChild(item);
                    }
                    lucide.createIcons(); // Re-init icons for new elements
                }
                
            }, 3000);
        });

        function goToRefine(url) {
            // If url is passed, use it, otherwise use the main result image
            const targetUrl = url || document.getElementById('resultImage').dataset.url;
            if (targetUrl) {
                // Navigate to refine page with image URL param
                window.location.href = `refine.html?img=${encodeURIComponent(targetUrl)}`;
            }
        }

    </script>
</body>
</html>
